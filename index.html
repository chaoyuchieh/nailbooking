                } catch (e) {
                    console.error("LIFF Init Failed:", e);
                    console.error("Error details:", {
                        message: e.message,
                        code: e.code,
                        liffId: LIFF_ID,
                        currentUrl: window.location.href,
                        isHttps: window.location.protocol === 'https:'
                    });
                    
                    const hint = document.getElementById('auto-login-hint');
                    hint.classList.remove('hidden', 'bg-blue-50', 'border-blue-200');
                    hint.classList.add('bg-red-50', 'border-red-200');
                    
                    let errorDetail = e.message;
                    let suggestion = '';
                    
                    if (e.message.includes('LIFF ID')) {
                        suggestion = 'è«‹æª¢æŸ¥ LIFF ID æ˜¯å¦æ­£ç¢º';
                    } else if (e.message.includes('Endpoint URL') || e.message.includes('redirect')) {
                        suggestion = 'è«‹æª¢æŸ¥ LINE Developers Console ä¸­çš„ Endpoint URL è¨­å®š';
                    } else if (window.location.protocol !== 'https:' && !window.location.hostname.includes('localhost')) {
                        suggestion = 'LIFF éœ€è¦ HTTPS ç’°å¢ƒï¼Œè«‹ä½¿ç”¨ Vercel éƒ¨ç½²æˆ– ngrok æ¸¬è©¦';
                    } else {
                        suggestion = 'è«‹æª¢æŸ¥ LINE Developers Console çš„æ‰€æœ‰è¨­å®š';
                    }
                    
                    hint.innerHTML = `
                        <div class="flex items-start gap-2 text-red-800 text-xs">
                            <i class="fas fa-exclamation-circle mt-0.5"></i>
                            <div>
                                <p class="font-bold mb-1">âŒ LIFF åˆå§‹åŒ–å¤±æ•—</p>
                                <p class="mb-1 text-red-700">éŒ¯èª¤: ${errorDetail}</p>
                                <p class="mb-2 text-red-600">ğŸ’¡ ${suggestion}</p>
                                <div class="flex gap-2">
                                    <button onclick="window.location.href='https://developers.line.biz/console/'" 
                                        class="text-xs bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700">
                                        å‰å¾€ Console æª¢æŸ¥
                                    </button>
                                    <button onclick="window.location.reload()" 
                                        class="text-xs bg-gray-600 text-white px-3 py-1 rounded hover:bg-gray-700">
                                        é‡æ–°è¼‰å…¥
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                }
